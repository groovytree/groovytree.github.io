---
layout: post
title: AWS Personalize
subtitle: 데이터 연동, 결과 활용
categories: AWS
tags: [AWS, Personalize, Docs]
---

## 개발자문서 요약
AWS Personalize만의 장점
- 기계 학습에 대해 알고 있거나 사용경험이 없더라도 사용자 개인화 서비스를 이용할 수 있다. 
- 생성 모델과 애플리케이션에서 새로 유입되는 데이터와 다시 결합하여 사용자에 대한 개인화 데이터를 얻을 수 있다.
- 모델과 교육, 결과에 대한 캠페인, 배포까지 가능하다.

1. 데이터세트
도메인 데이터세트와 사용자 데이터세트로 나뉜다. 두 케이스 모두 스키마를 정의하고 스키마에 부합하는 데이터세트를 업로드, 레시피에 따라 모델을 결정하며 권장사항 결과를 배치 추론과 캠페인, 고객세그먼트 작업으로 사용할 수 있다. 데이터는 최소 1000개의 레코드가 있으며 2가지 행동 이상에 대하여 고유 고객 25명 이상이 정의되어 있어야 한다. 데이터세트는 필수 이벤트 항목에 대해 정의된 컬럼이 병행으로 들어있고, 사용자 데이터세트는 이보다 정밀한 기준이 필요하고 이는 아래에서 다시 설명한다. 레시피를 간단히 선택함으로써 기계학습에 대한 선행연구가 없어도 되며, 고객이 사용하는 기기가 어떤 것인지에 따라 다른 결과를 내주는 레시피까지 그 종류가 다양하다. 레시피를 세밀하게 지정하고 싶을 경우에도 추후에 다시 설명하겠다. 
- 도메인 데이터세트는 유입되는 데이터에 대하여 전자상거래, 비디오 추천 등의 비즈니스 애플리케이션이 연결된 경우에 사용한다. 이는 사용자 데이터세트에 대해 학습된 솔루션과 같은 리소스를 사용하도록 추가할 수 있다. 사용자 데이터세트는 비즈니스 애플리케이션 데이터가 연결되지 않은 경우에 사용하며, 도메인 데이터세트보다 정밀한 카탈로그가 요구되는 것으로 보인다.
- 데이터세트그룹을 컨테이너로 하여 데이터 가져오기, 모델 교육, 배포까지의 과정을 서비스로 경험한다. 하나의 데이터세트는 다른 데이터세트의 리소스에 간섭이 없다. 데이터세트그룹은 도메인 데이터세트그룹이거나 사용자 데이터세트그룹이다. 사용자 데이터세트그룹을 선택하여 사용할 경우 나중에 도메인 데이터세트그룹으로 변경할 수 없다.

2. 용어들
데이터
- 노출(Impression): 암시적 노출과 명시적 노출. 데이터세트에 수동으로 추가하는 항목 목록을 명시적 노출이라고 한다. 서비스에서 제공하는 추천 항목이 암시적 노출로 권장되고 사용자가 직접 선택하여 제품을 명시적 노출시킬 수 있다.
- 노출수 데이터: 사용자가 특정 항목에 대하여 노출된 아이템을 무시하거나 비슷한 아이템을 선택한 빈도를 통해서 새롭게 노출할 관련 아이템을 찾는 데에 사용되는 데이터
- 상호 작용 데이터 세트: 사용자와 아이템간의 상호 작용에서 수집한 기록. 여기에는 노출수 데이터와 컨텍스트 메타데이터가 포함된다.
- 컨텍스트 메타데이터: 이벤트(검색, 클릭 등)가 발생했을 때 사용자가 검색한 기기와 사용위치, 검색어 등의 컨텍스트 데이터를 수집. 기기와 사용위치 등의 정보는 검색어와 합쳐져서 상황별 메타데이터를 발생시키고, 이는 신규 사용자에 대한 권장 사항 관련성을 개선할 수 있다.
- 항목 데이터 세트: 아이템과 가격 장르 등 메타데이터
- 유저 데이터 세트: 연령, 성별, 멤버십과 충성도 등 사용자에 대한 메타데이터. 해당 데이터 세트의 항목은 최대 5개까지 가능하다. 

모델훈련
- 항목간유사성(SIMS) 레시피: 아이템에 대하여 장르, 색상 등의 속성으로 비슷한 항목을 찾는 것이 아니라 사용자와 아이템 간의 상호작용의 유사성을 통하여 항목을 추천
- 항목 선호도 레시피: 사용자가 아이템에 대하여 상호작용할 가능성에 대하여 상호작용 데이터세트를 활용하여 사용자를 세그먼트하는 레시피
- 항목-속성 선호도 레시피: 사용자가 아이템-속성에 대하여 상호작용할 가능성에 대하여 ~
- 맞춤형 랭킹 레시피: 특정 사용자에 대하여 예측된 관심 수준을 기준으로 항목을 순위화할 수 있습니다.

3. 개인화로 가져올 수 있는 데이터 유형
- 상호 작용 데이터: 노출수, 컨텍스트 메타
- 사용자 데이터: 카테고리 메타(범주형)
- 아이템 데이터: 타임스탬프, 카테고리 메타, 비정형 텍스트(리뷰 등)

4. 데이터 세트 및 스키마

5. 솔루션 생성
5-1. 솔루션 선택
- 사용자 개인화 (USER_PERSONALIZATION) 레시피
	- 2시간 마다 새로 추가된 데이터에 대하여 자동 업데이트할 수 있으며, 비용이 들지 않고 솔루션 버전이 올라가는 것은 아님
	- 노출 데이터는 고객의 긍정적 피드백 뿐 아니라 이벤트에 대하여 노출이 무시된 횟수도 고려함
	- 하이퍼파라미터: 
		- hidden_dimension: 상호작용 메타데이터에 대한 패턴이 복잡할 경우 차원을 지정할 수 있다
		- bptt: 역전파
		- recency_mask: 최근 이벤트에 더 많은 가중치를 부여할 수 있다. true
		- 그 외 노이즈 감소, 최신 상호작용 이후 탐색 항목과 빈도 결정 파라미터
- Popularity-Count 
	- 다른 알고리즘에 대한 평가 지표로 활용하기 좋음
	- NO 하이퍼파라미터
- 레거시 사용자 개인화 레시피
	- HRNN 레시피: 사용자의 의도와 관심사의 변화를 수용
	- HRNN META 레시피: 사용자가 상호작용할 항목을 예측
	- HRNN COLD 레시피: 새로운 항목이 자주 추가되고 변경될 때
		- 하이퍼파라미터: 위와 동일하고 아래는 다른 점
			- 콜드 스타트 상황에 맞게 상호작용 데이터에 대한 항목 제한
	- AutoML: HRNN 레시피를 입력 데이터에 따라 자동으로 선택하게 함
- PERSONALIZED_RANKING 레시피
	- 고객에게 제공하고자 하는 선별된 목록이 이미 있고, 각 사용자에 대하여 이를 재종하려고 하는 경우에 유용함
	- 컨텍스트 메타, 비정형 텍스트 데이터를 필요로 할 수 있음
- RELATED_ITEMS 레시피
	- 유사 항목
		- 상호작용 데이터와 항목 데이터를 기반으로 계산
	- SIMS 
		- 항목에 대한 사용자의 데이터가 적거나 항목에 대한 데이터를 찾을 수 없는 경우, 인기 항목 데이터를 반환함
	- 유사 아이템
- USER_세분화 레시피
	- 각 항목에 대하여 사용자의 선호도의 감소에 따라 사용자를 내림차순으로 정렬하여 값을 제공함
	- 아이템 선호도, 아이템-속성 선호도 등

5-2. 솔루션 구성

6. 필터 및 고객 세그먼트
- 필터: 추천 결과에 대하여 사용자가 의도한 필터를 적용할 수 있음. 특정 클릭 아이템을 필터링하여 보여주거나 특정 항목을 숨기거나. exclude, include 필터링 표현식을 참조

7. 보안

8. 로깅


## 궁금사항
1. 정의: 사용자 개인화 서비스를 제공하는가, 사용자 개인화 추천 서비스가 제공되는가. 
2. 7페이지 명시적 노출 - 사용자가 직접 선택하여 노출하고자 하는 제품을 의미하는가. 데이터세트에 포함하는 항목으로써 수동으로 선택.
3. 8 페이지 모델 교육 - 좋은 레시피들을 여러 개 조합하여 다 취할 순 없는지	
	- (X) 인기 카운트 레시피; 가장 많은 사용자들이 선택한 인기 항목에 대하여 다른 사용자에게 권하는 레시피인가. => 평가지표로 활용됨
	- 사용자 개인화 레시피
4. 데이터세트에서 나오는 예약어
	- 증분으로 데이터 가져오기 는 실습 해보면 좋을 듯
5. 118 페이지 - bptt 시간 기법을 통한 역전파를 하면 구매 보상에 대한 장기 효과를 기대할 수 있다?


251

## 나중에 읽을 페이지
Amazon Personalize 설정 14 - 21 p
데이터 세트 및 스키마 54 - 114
솔루션 최적화 149 - 153
캠페인 생성, 실시간 권장 사항 가져오기 ~ 173 ~ 


